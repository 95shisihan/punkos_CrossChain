# 跨链区概述

## 设计目标
跨链区是磐古系统的一个分区，致力构建去中心、激励相容、高安全、可持续的跨链互操作基础设施，实现磐谷系统生态与Web3生态的互联互通。具体来说，使得磐古系统成为
- Web3生态（现有以及未来）区块链的超级侧链
- 成为Web3区块链互联互通的中继链

## 跨链区概述

### 主要术语

- `源链（SourceChain）`：Web3生态中现有的以及未来的区块链统称为源链，例如比特币、以太坊等区块链。
- `中继链（HubChain）`：承载跨链区功能的底层区块链。中继链由磐古系统的其它模块提供一个通用的区块链架构，由跨链区针对跨链场景进行针对性优化。
- `跨链桥（Bridge）`：实现中继链与源链数据互联互通、相互信任的组件，由一系列的合约、客户端、钱包组成。
- `系统合约(System Contract)`：提供系统级服务的智能合约。系统合约需要满足一定规则，其部署启动流程需要治理区进行安全审计，合约运行的gas嵌入系统底层的激励。


### 系统架构

跨链区是一个支持异构多链互操作的跨链基础设施，分为
- 中继链/链基础设施：
   - `治理层`：执行区块链上难以确定性执行的复杂事务（例如系统级协议的开发与可信启动，已部署系统协议的故障处理与升级）
   - `共识层`：提供一个安全、高效、去中心账本
   - `执行层`：保障区块链账本正确执行图灵完备的事务
- 跨链桥/跨链基础设施：
  - `跨链管理层`：定义跨链桥中的复杂跨链事务，调用治理区接口进行执行
  - `跨链信任层`：使得中继链具有验证源链数据有效性的能力
  - `跨链传输层`：连接跨链信任层与互操作层，主要功能是支持中继链向源链发送可信数据、权衡跨链安全性与延迟、保障跨链互操作的顺序执行
- 跨链应用：
  - `互操作层`：保障跨链交易的原子性

### 主要协议
- `（单向）跨链信任中继协议`：实现中继链对源链跨链读的协议。核心是通过系统合约维护源链的影子账本（链上轻节点、超轻节点等），辅以一系列的安全保障和激励机制。主要参与角色为中继链矿工、中继搬运工。
- `（双向）跨链消息传输协议`：实现中继链对源链跨链写的协议。核心是中继链将用户的跨链操作请求打包成合法的源链交易单。主要参与角色为中继链矿工、传输搬运工、跨链用户。
- `复杂跨链事务治理协议`：通过治理区对跨链区系统合约进行登记、启动、参数修改的协议。

### 主要角色
- `中继链矿工`：参与中继链共识协议，处理跨链区各类交易单并生成中继链新区块的角色。
- `搬运工`：维护跨链桥的主要角色（另一个角色是中继链矿工），通过链下组件联通跨链区中继链与源链。根据参与的具体协议，分为中继搬运工和传输搬运工。
- `跨链区管理员`：对跨链区系统合约进行可信部署、登记、启动、修改关键参数的角色，目前的设想是由多签名控制的某个治理区合约。
- `跨链用户`：在中继链和源链之间进行跨链写的角色，当前需要维护两条链的钱包，不能托管。

### 项目结构

```tree 
CrosschainZone/  
├── src/                                            # 智能合约组件  
├── script/                                         # 合约部署和启动脚本
├── client/                                         # 与合约交互地链下客户端 
├── vue/                                            # 前端组件
├── database/                                       # 数据库组件
├── docs/                                            # 文档目录
└── readme.md                                       # 跨链区简介
```

### 主要链上组件

- **系统合约模版**：跨链区主要以智能合约的形式，提供支持跨链互操作的底层服务。与通常意义上的智能合约相比，这些合约安全需求更高且由于远离应用需要进行针对性激励设计，因此跨链区设计了系统合约模版。
- **多链管理合约**：最特殊的跨链区系统合约。主要功能是维护跨链区内所有系统合约的相关信息，是治理区管理跨链区系统合约的统一入口。
- **源链规则接口**：实现跨链区对异构源链规则的抽象化。最终部署的支持跨链区与源链互操作的跨链桥，既包含源链自身的规则，也包含跨链区设计的规则。通过提供源链规则接口，能够将源链规则与跨链规则解耦，从而相对独立地进行代码开发、测试、审计、升级；也能够在设计跨链区规则时，降低源链异构性带来的干扰。
- **抽象中继合约**：跨链区基于源链规则接口开发的跨链规则，规则的主要目的是为跨链中继协议参与者提供奖惩机制，具体来说奖励诚实参与者的行为，识别恶意参与者的行为并进行惩罚
- **实例化影子客户端合约**：来自源链的跨链桥开发者基于源链规则接口开发的源链规则，规则的主要目的是基于源链的矿工、全节点、轻节点、超轻节点客户端，开发出一个无需信任、链上成本可控的影子客户端。该影子客户端在可信启动后，通过接收来自中继搬运工群体的消息（群体中至少一个诚实节点），维护与源链账本同步的影子账本，并基于该影子账本验证源链交易的有效性。
- **实例化中继合约**：最终在跨链区运行的，承载源链规则与跨链区规则的跨链中继协议。

 

